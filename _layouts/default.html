<!doctype html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">

  {% include head.html %}

  <body>

    <div class="container pure-g">
      {%- assign cover_bg_color = site.cover_bg_color | default: "rgb(40, 73, 77)" -%}
      {%- assign cover_color    = site.cover_color    | default: "rgb(255, 255, 255)" -%}
      {%- assign cover_image    = site.cover_image -%}
      {%- if page.cover_bg_color -%}
        {%- assign cover_bg_color  = page.cover_bg_color -%}
      {%- endif -%}
      {%- if page.cover_color -%}
        {%- assign cover_color     = page.cover_color -%}
      {%- endif -%}
      {%- if page.cover_image -%}
        {%- assign cover_image     = page.cover_image -%}
      {%- endif -%}
      <div id="sidebar-left" class="sidebar-left pure-u-1 pure-u-md-1-4" style="background-color: {{ cover_bg_color }}; color: {{ cover_color}}; {% if cover_image %}background-image: url({{ cover_image | relative_url }});{% endif %}">
        {%- include sidebar-left.html -%}
      </div>

      <div class="content pure-u-1 pure-u-md-1-2">
        {%- include content.html -%}
      </div>
      <div class="sidebar-right pure-u-1 pure-u-md-1-4">
        {%- include sidebar-right.html -%}
      </div>
    </div>

    <script async src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>

    {%- include scroll.html -%}

    {%- if page.math -%}
      {% include mathjax.html %}
    {%- endif -%}

    {%- if jekyll.environment == 'production' and site.google_analytics -%}
      {%- include google-analytics.html -%}
    {%- endif -%}

    <script>
      // 动态背景更换功能
      document.addEventListener('DOMContentLoaded', function() {
        // 定义背景图片数组（已重命名为数字）
        const backgroundImages = [
          '{{ "bg/1.jpg" | relative_url }}',
          '{{ "bg/2.jpg" | relative_url }}',
          '{{ "bg/3.jpg" | relative_url }}',
          '{{ "bg/4.jpg" | relative_url }}',
          '{{ "bg/5.jpg" | relative_url }}',
          '{{ "bg/6.jpg" | relative_url }}',
          '{{ "bg/7.jpg" | relative_url }}',
          '{{ "bg/8.jpg" | relative_url }}',
          '{{ "bg/9.jpg" | relative_url }}',
          '{{ "bg/10.jpg" | relative_url }}',
          '{{ "bg/11.jpg" | relative_url }}',
          '{{ "bg/12.jpg" | relative_url }}',
          '{{ "bg/13.jpg" | relative_url }}',
          '{{ "bg/14.jpg" | relative_url }}',
          '{{ "bg/15.jpg" | relative_url }}',
          '{{ "bg/16.jpg" | relative_url }}',
          '{{ "bg/17.jpg" | relative_url }}',
          '{{ "bg/18.jpg" | relative_url }}',
          '{{ "bg/19.jpg" | relative_url }}',
          '{{ "bg/20.jpg" | relative_url }}'
        ];
        
        // 获取侧边栏的正确元素（使用ID选择器）
        const sidebar = document.getElementById('sidebar-left');
        
        // 确保侧边栏元素存在
        if (!sidebar) {
          console.error('Sidebar element not found!');
          return;
        }
        
        // 设置侧边栏背景样式，确保图片充满整个区域并保留中心内容
        sidebar.style.backgroundSize = 'cover';
        sidebar.style.backgroundPosition = 'center';
        sidebar.style.backgroundRepeat = 'no-repeat';
        
        // 预加载所有背景图片
        const preloadImages = [];
        backgroundImages.forEach(imgSrc => {
          const img = new Image();
          img.src = imgSrc;
          preloadImages.push(img);
        });
        
        // 设置背景过渡效果
        sidebar.style.transition = 'opacity 1.5s ease-in-out';
        
        // 从随机起始点开始
        let currentIndex = Math.floor(Math.random() * backgroundImages.length);
        
        // 更换背景图片的函数
        function changeBackground() {
          // 使用透明度过渡避免切换空白
          sidebar.style.opacity = '0';
          
          setTimeout(() => {
            // 更换背景图片
            sidebar.style.backgroundImage = `url(${backgroundImages[currentIndex]})`;
            // 恢复透明度
            sidebar.style.opacity = '1';
            
            // 更新索引（顺序播放，循环）
            currentIndex = (currentIndex + 1) % backgroundImages.length;
          }, 1500);
        }

        // 设置初始背景（使用随机起始图片）
        sidebar.style.backgroundImage = `url(${backgroundImages[currentIndex]})`;
        sidebar.style.opacity = '1';
        
        // 设置定时器，每30秒更换一次背景
        setInterval(changeBackground, 30000);
      });
    </script>
  </body>
</html>