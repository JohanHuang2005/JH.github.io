<!doctype html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">

  {% include head.html %}

  <body>

    <div class="container pure-g">
      {%- assign cover_bg_color = site.cover_bg_color | default: "rgb(40, 73, 77)" -%}
      {%- assign cover_color    = site.cover_color    | default: "rgb(255, 255, 255)" -%}
      {%- assign cover_image    = site.cover_image -%}
      {%- if page.cover_bg_color -%}
        {%- assign cover_bg_color  = page.cover_bg_color -%}
      {%- endif -%}
      {%- if page.cover_color -%}
        {%- assign cover_color     = page.cover_color -%}
      {%- endif -%}
      {%- if page.cover_image -%}
        {%- assign cover_image     = page.cover_image -%}
      {%- endif -%}
      <div id="sidebar-left" class="sidebar-left pure-u-1 pure-u-md-1-4" style="background-color: {{ cover_bg_color }}; color: {{ cover_color}}; {% if cover_image %}background-image: url({{ cover_image | relative_url }});{% endif %}">
        {%- include sidebar-left.html -%}
      </div>

      <div class="content pure-u-1 pure-u-md-1-2">
        {%- include content.html -%}
      </div>
      <div class="sidebar-right pure-u-1 pure-u-md-1-4">
        {%- include sidebar-right.html -%}
      </div>
    </div>

    <script async src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>

    {%- include scroll.html -%}

    {%- if page.math -%}
      {% include mathjax.html %}
    {%- endif -%}

    {%- if jekyll.environment == 'production' and site.google_analytics -%}
      {%- include google-analytics.html -%}
    {%- endif -%}

    <script>
      // 动态背景更换功能
      document.addEventListener('DOMContentLoaded', function() {
        // 定义背景图片数组（已重命名为数字）
        const backgroundImages = [
          '/bg/1.jpg', '/bg/2.jpg', '/bg/3.jpg', '/bg/4.jpg', '/bg/5.jpg',
          '/bg/6.jpg', '/bg/7.jpg', '/bg/8.jpg', '/bg/9.jpg', '/bg/10.jpg',
          '/bg/11.jpg', '/bg/12.jpg', '/bg/13.jpg', '/bg/14.jpg', '/bg/15.jpg',
          '/bg/16.jpg', '/bg/17.jpg', '/bg/18.jpg', '/bg/19.jpg', '/bg/20.jpg'
        ];
        
        // 获取侧边栏的正确元素
        const sidebar = document.querySelector('.sidebar-left');
        
        // 确保侧边栏元素存在
        if (!sidebar) {
          console.error('Sidebar element not found!');
          return;
        }
        
        // 设置侧边栏为相对定位，以便背景图片能正确显示
        sidebar.style.position = 'relative';
        sidebar.style.zIndex = '1';
        
        // 确保侧边栏背景样式正确
        sidebar.style.backgroundSize = 'cover';
        sidebar.style.backgroundPosition = 'center';
        sidebar.style.backgroundRepeat = 'no-repeat';
        sidebar.style.transition = 'opacity 0.5s ease-in-out';
        
        let currentIndex = 0;
        
        // 更换背景图片的函数
        function changeBackground() {
          // 淡入淡出效果
          sidebar.style.opacity = '0.7';
          
          setTimeout(() => {
            // 更换背景图片
            sidebar.style.backgroundImage = `url(${backgroundImages[currentIndex]})`;
            
            // 淡入效果
            setTimeout(() => {
              sidebar.style.opacity = '1';
            }, 300);
            
            // 更新索引
            currentIndex = (currentIndex + 1) % backgroundImages.length;
          }, 500);
        }

        // 设置初始背景（使用第一张图片）
        sidebar.style.backgroundImage = `url(${backgroundImages[0]})`;
        
        // 调试：检查图片路径是否正确
        console.log('Background images loaded:', backgroundImages);
        console.log('Current background:', backgroundImages[0]);
        console.log('Sidebar element:', sidebar);
        console.log('Sidebar background style:', sidebar.style.backgroundImage);
        
        // 设置定时器，每5秒更换一次背景
        setInterval(changeBackground, 5000);
        
        // 首次更换背景（2秒后开始）
        setTimeout(() => {
          currentIndex = 1; // 从第二张图片开始
          changeBackground();
        }, 2000);
      });
    </script>
  </body>
</html>